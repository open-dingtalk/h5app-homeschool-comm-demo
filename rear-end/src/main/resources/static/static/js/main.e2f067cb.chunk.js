(this["webpackJsonpfront-end"]=this["webpackJsonpfront-end"]||[]).push([[0],{285:function(t,e,s){},294:function(t,e,s){"use strict";s.r(e);var n=s(1),a=s.n(n),i=s(37),c=s.n(i),o=(s(48),s(38)),r=s(39),d=s(43),u=s(42),h=s(40),l=s(13),g=s.n(l),p=(s(285),s(4)),f=s(2);function j(t){return 1===t.showType?Object(f.jsxs)("div",{children:[Object(f.jsx)("h3",{children:t.className}),Object(f.jsx)("h4",{children:"\u653e\u5b66\u901a\u77e5"}),t.students.map((function(e,s){return Object(f.jsxs)("label",{children:[Object(f.jsx)("input",{type:"checkbox",value:e.userid,name:e.name,onChange:t.addUser}),Object(f.jsx)("span",{children:e.name})]},"stu"+s)})),Object(f.jsxs)("p",{children:["\u653e\u5b66\u65f6\u95f4\uff1a",Object(f.jsx)("input",{type:"date",value:t.time,onChange:t.onChange})]}),Object(f.jsx)("p",{children:Object(f.jsx)("button",{onClick:t.onClick,children:"\u53d1\u9001\u653e\u5b66\u901a\u77e5"})})]}):Object(f.jsx)("div",{})}var m=function(t){Object(d.a)(s,t);var e=Object(u.a)(s);function s(t){var n;return Object(o.a)(this,s),(n=e.call(this,t)).state={domain:"",corpId:"",authCode:"",userId:"",userName:"",deptList:[],deptId:0,students:[],classUserList:[],showType:0,className:"",classId:"",origin:"",sendMessage:{stuList:[],title:"\u653e\u5b66\u901a\u77e5",text:"\u653e\u5b66\u65f6\u95f4\u4e3a",time:""}},n}return Object(r.a)(s,[{key:"addUser",value:function(t){console.log(t.target.value),console.log(t.target.name);var e=this.state.sendMessage;e.stuList.push({id:t.target.value,name:t.target.name}),this.setState({sendMessage:e})}},{key:"setTime",value:function(t){alert("time:",t.target.value);var e=this.state.sendMessage;e.time=t.target.value,this.setState({sendMessage:e})}},{key:"sendMsg",value:function(t){var e=this,s=this.state.sendMessage;s.classId=this.state.classId,s.origin=this.state.origin,g.a.post(this.state.domain+"/homeschool/sendMsg",JSON.stringify(s),{headers:{"Content-Type":"application/json"}}).then((function(t){alert("\u653e\u5b66\u901a\u77e5\u5df2\u53d1\u51fa\uff01"),e.setState({sendMessage:{stuList:[],title:"\u653e\u5b66\u901a\u77e5",text:"\u653e\u5b66\u65f6\u95f4\u4e3a\uff1a",time:""}})})).catch((function(t){alert("tongzhi err "+JSON.stringify(t))}))}},{key:"render",value:function(){var t,e=this;if(""===this.state.userId&&this.login(),""===this.state.origin){var s=window.location.origin;this.setState({origin:s})}return t=0===this.state.showType?Object(f.jsxs)("div",{children:[Object(f.jsx)("h3",{children:"\u9009\u62e9\u90e8\u95e8\uff1a"}),this.state.deptList.map((function(t,s){return Object(f.jsx)("div",{children:Object(f.jsx)("p",{children:Object(f.jsx)("u",{children:Object(f.jsx)("span",{onClick:function(s){return e.chooseDept(s,t.deptId,t.deptType,t.name)},children:t.name})})})},s)}))]}):Object(f.jsx)("div",{}),Object(f.jsxs)("div",{children:[t,Object(f.jsx)(j,{showType:this.state.showType,students:this.state.students,className:this.state.className,addUser:function(t){return e.addUser(t)},onChange:function(t){return e.setTime(t)},time:this.state.sendMessage.time,onClick:function(t){return e.sendMsg(t)}})]})}},{key:"chooseDept",value:function(t,e,s,n){console.log("chooseDept deptId : "+e),"class"===s?(this.setState({classId:e,className:n}),this.getClassUserList(e)):(this.setState({deptId:e}),this.getDeptList(e))}},{key:"getClassUserList",value:function(t){var e=this;g.a.get(this.state.domain+"/homeschool/classUserList?classId="+t).then((function(t){alert("students --- "),e.setState({students:t.data.data.result.details,showType:1})})).catch((function(t){alert("class err "+JSON.stringify(t))}))}},{key:"getDeptList",value:function(t){var e=this;g.a.get(this.state.domain+"/homeschool/deptList?deptId="+t).then((function(t){e.setState({deptList:t.data.data.result.details,showType:0})})).catch((function(t){alert("dept err "+JSON.stringify(t))}))}},{key:"login",value:function(){var t=this;g.a.get(this.state.domain+"/getCorpId").then((function(e){e.data&&t.loginAction(e.data)})).catch((function(t){alert("corpId err, "+JSON.stringify(t))}))}},{key:"loginAction",value:function(t){var e=this;h.runtime.permission.requestAuthCode({corpId:t,onSuccess:function(t){e.state.authCode=t.code,g.a.get(e.state.domain+"/login?authCode="+e.state.authCode).then((function(t){if(t&&t.data.success){var s=t.data.data.userId,n=t.data.data.userName;alert("\u767b\u5f55\u6210\u529f\uff0c\u4f60\u597d"+n),setTimeout((function(){e.setState({userId:s,userName:n})}),0),e.getDeptList(0)}else alert("login failed ---\x3e"+JSON.stringify(t))})).catch((function(t){alert("httpRequest failed ---\x3e"+JSON.stringify(t))}))},onFail:function(t){alert("requestAuthCode failed ---\x3e"+JSON.stringify(t))}})}}]),s}(a.a.Component),v=Object(p.e)(m),O=function(t){t&&t instanceof Function&&s.e(3).then(s.bind(null,295)).then((function(e){var s=e.getCLS,n=e.getFID,a=e.getFCP,i=e.getLCP,c=e.getTTFB;s(t),n(t),a(t),i(t),c(t)}))},b=s(21);c.a.render(Object(f.jsx)(b.a,{basename:"/",children:Object(f.jsx)(p.a,{path:"/",component:v})}),document.getElementById("root")),O()},48:function(t,e,s){}},[[294,1,2]]]);
//# sourceMappingURL=main.e2f067cb.chunk.js.map